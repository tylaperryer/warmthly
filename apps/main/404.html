<!DOCTYPE html>
<html lang="en">
<head>
  <script>
    // Phase 7 Issue 7.2: Set lang attribute dynamically before page load
    (function() {
      function detectLanguage() {
        const urlParams = new URLSearchParams(window.location.search);
        const urlLang = urlParams.get('lang');
        if (urlLang) {
          const normalized = urlLang.toLowerCase().split('-')[0].split('_')[0];
          if (normalized.length >= 2 && normalized.length <= 3) return normalized;
        }
        try {
          const storedLang = localStorage.getItem('warmthly_language');
          if (storedLang) {
            const normalized = storedLang.toLowerCase().split('-')[0].split('_')[0];
            if (normalized.length >= 2 && normalized.length <= 3) return normalized;
          }
        } catch {}
        const browserLang = navigator.language || navigator.userLanguage;
        if (browserLang) {
          const normalized = browserLang.toLowerCase().split('-')[0].split('_')[0];
          if (normalized.length >= 2 && normalized.length <= 3) return normalized;
        }
        return 'en';
      }
      const lang = detectLanguage();
      document.documentElement.setAttribute('lang', lang);
      const rtlLanguages = ['ar', 'he', 'fa', 'ur', 'yi', 'ji', 'iw'];
      if (rtlLanguages.includes(lang)) {
        document.documentElement.setAttribute('dir', 'rtl');
      }
    })();
  </script>
  <script type="module" src="/lego/components/warmthly-head.js"></script>
  <warmthly-head 
    title="404 - Page Not Found - Warmthly"
    description="The page you're looking for doesn't exist"
    app="main"
    viewport="0.75"
    robots="noindex, nofollow">
  </warmthly-head>
  
  <style>
    /* Critical CSS - Must be inline for performance */
    :root { color-scheme: light; }
    html { background-color: #fff6f1; min-height: 100%; }
    body.fonts-loaded { opacity: 1; visibility: visible; }
    
    /* Page-specific styles */
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: var(--spacing-24) var(--spacing-8) var(--spacing-16);
      color: var(--text-color);
      position: relative;
      text-align: center;
    }
    
    .big-404 {
      font-family: 'Inter', sans-serif;
      font-size: var(--font-size-4xl);
      font-weight: 600;
      line-height: var(--line-height-tight);
      color: var(--warmthly-orange);
      margin-bottom: var(--spacing-4);
      user-select: none;
      position: relative;
      letter-spacing: var(--letter-spacing-tight);
      opacity: 0;
      transform: translateY(-20px);
      animation: fadeInUp 0.8s cubic-bezier(0.25, 0.8, 0.25, 1) 0.2s forwards;
    }
    
    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .page-title {
      font-family: 'Inter', sans-serif;
      font-size: var(--font-size-2xl);
      line-height: var(--line-height-tight);
      color: var(--warmthly-orange);
      margin-bottom: var(--spacing-4);
      font-weight: 600;
      letter-spacing: var(--letter-spacing-normal);
      opacity: 0;
      animation: fadeInUp 0.8s cubic-bezier(0.25, 0.8, 0.25, 1) 0.4s forwards;
    }
    
    .subtitle {
      font-family: 'Inter', sans-serif;
      font-size: var(--font-size-lg);
      line-height: var(--line-height-base);
      color: var(--text-color);
      opacity: 0.8;
      margin-bottom: var(--spacing-12);
      opacity: 0;
      animation: fadeInUp 0.8s cubic-bezier(0.25, 0.8, 0.25, 1) 0.6s forwards;
    }
    
    .music-section {
      background: linear-gradient(135deg, rgba(255, 140, 66, 0.08), rgba(255, 140, 66, 0.03));
      padding: var(--spacing-12) var(--spacing-10);
      border-radius: var(--radius-xl);
      margin: var(--spacing-12) 0;
      border: 1px solid rgba(255, 140, 66, 0.15);
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 0.8s cubic-bezier(0.25, 0.8, 0.25, 1) 0.8s forwards;
    }
    
    .music-title {
      font-family: 'Inter', sans-serif;
      font-size: var(--font-size-xl);
      line-height: var(--line-height-tight);
      color: var(--warmthly-orange);
      margin-bottom: var(--spacing-6);
      font-weight: 600;
    }
    
    .music-description {
      color: var(--text-color);
      opacity: 0.8;
      margin-bottom: var(--spacing-8);
      line-height: var(--line-height-base);
      font-size: var(--font-size-lg);
    }
    
    .spotify-embed {
      margin: 0 auto;
      max-width: 100%;
      box-shadow: 0 var(--spacing-2) var(--spacing-6) rgba(255, 140, 66, 0.15);
      border-radius: var(--radius-md);
      overflow: hidden;
    }
    .spotify-embed iframe {
      border-radius: var(--radius-md);
    }
    
    .navigation-help {
      margin: var(--spacing-12) 0;
      opacity: 0;
      animation: fadeInUp 0.8s cubic-bezier(0.25, 0.8, 0.25, 1) 1s forwards;
    }
    
    .nav-title {
      font-family: 'Inter', sans-serif;
      font-size: var(--font-size-xl);
      line-height: var(--line-height-tight);
      color: var(--warmthly-orange);
      margin-bottom: var(--spacing-6);
      font-weight: 600;
    }
    
    .nav-buttons {
      display: flex;
      justify-content: center;
      gap: var(--spacing-6);
      flex-wrap: wrap;
      margin-bottom: var(--spacing-8);
    }
    
    .nav-button {
      padding: var(--spacing-4) var(--spacing-8);
      border: 2px solid var(--warmthly-orange);
      border-radius: var(--radius-md);
      background: transparent;
      color: var(--warmthly-orange);
      font-family: 'Inter', sans-serif;
      font-weight: 600;
      font-size: var(--font-size-base);
      line-height: var(--line-height-base);
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
      text-decoration: none;
      display: inline-block;
      letter-spacing: var(--letter-spacing-normal);
    }
    
    .nav-button:hover,
    .nav-button:focus {
      background: var(--warmthly-orange);
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 var(--spacing-2) var(--spacing-4) rgba(255, 140, 66, 0.2);
      outline: none;
    }
    
    .nav-button:focus-visible {
      outline: 3px solid var(--warmthly-orange);
      outline-offset: 2px;
    }
    
    .nav-button:active {
      transform: translateY(0px) scale(0.98);
    }
    
    @media (max-width: 768px) {
      .container {
        padding: var(--spacing-20) var(--spacing-6) var(--spacing-10);
      }
      .big-404 {
        font-size: var(--font-size-3xl);
      }
      .page-title {
        font-size: var(--font-size-xl);
      }
      .subtitle {
        font-size: var(--font-size-base);
      }
      .music-section {
        padding: var(--spacing-8) var(--spacing-6);
      }
      .nav-buttons {
        flex-direction: column;
        align-items: center;
      }
      .nav-button {
        min-width: 250px;
        width: 100%;
        max-width: 300px;
      }
    }
  </style>
  
  
  <!-- DNS prefetch for external domains -->
  <link rel="dns-prefetch" href="//warmthly.org">
  
  <script type="module" src="/lego/components/warmthly-header.js"></script>
  <script type="module" src="/lego/components/warmthly-stoplight.js"></script>
  <script type="module" src="/lego/components/warmthly-reading-level.js"></script>
  <script type="module" src="/lego/components/warmthly-media-accessibility.js"></script>
  <script type="module" src="/lego/components/warmthly-font-loader.js"></script>
  <script type="module" src="/lego/utils/init.js"></script>
  <script type="module">
    import { initReadingLevel } from '/lego/utils/reading-level.js';
    import { initAbbreviations } from '/lego/utils/abbreviations.js';
    import { initGlossary } from '/lego/utils/glossary.js';
    import { initPronunciation } from '/lego/utils/pronunciation.js';
    initReadingLevel();
    initAbbreviations();
    initGlossary();
    initPronunciation();
  </script>
</head>
<body class="fonts-loading">
  <div class="preload-fonts"></div>
  
  <warmthly-header app="main"></warmthly-header>
  
  <div style="display: flex; gap: 1rem; justify-content: flex-end; padding: 1rem; align-items: center;">
    <warmthly-reading-level></warmthly-reading-level>
    <warmthly-stoplight app="main"></warmthly-stoplight>
  </div>

  <div class="container">
    <div class="big-404">404</div>
    <h1 class="page-title" data-reading-level-content>This page went on a little adventure.</h1>
    <p class="subtitle" data-reading-level-content>
      It seems the page you were looking for has wandered off.
    </p>
    
    <div class="music-section">
      <h3 class="music-title" data-reading-level-content>An Unexpected Interlude</h3>
      <p class="music-description" data-reading-level-content>
        Sometimes getting lost leads to exactly what we need to hear. Here's a song for this quiet moment.
      </p>
      <div class="spotify-embed">
        <iframe src="https://open.spotify.com/embed/track/3G69U3e9pdEdrD1yUkpWuZ?utm_source=generator" width="100%" height="352" frameBorder="0" allowfullscreen allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy" title="Spotify audio player"></iframe>
      </div>
      <warmthly-media-accessibility
        audio-id="spotify-embed"
        transcript-url="/transcripts/404-song.txt"
        transcript-text="This is a musical interlude on the 404 error page. The song provides a moment of reflection when a page cannot be found. The music is decorative and not essential to understanding the page content. The main message is that the page you were looking for has wandered off, and you can return home or go back to the previous page.">
      </warmthly-media-accessibility>
    </div>
    
    <div class="navigation-help">
      <h3 class="nav-title">Let's find your way.</h3>
      <div class="nav-buttons">
        <a href="/" class="nav-button" id="home-link">Return Home</a>
        <button class="nav-button" type="button" onclick="window.history.back()" aria-label="Go back to previous page">Go Back</button>
      </div>
    </div>
    
  </div>
  
  <!-- Font Loader Component -->
  <warmthly-font-loader></warmthly-font-loader>
  
  <script type="module">
    // Update home link URL from config
    import { WARMTHLY_CONFIG } from '/lego/config/warmthly-config.js';
    const homeLink = document.getElementById('home-link');
    if (homeLink) {
      homeLink.href = WARMTHLY_CONFIG.urls.main;
    }
  </script>
</body>
</html>
